import unittest
from numpy import testing
import numpy as np
from fda.basis import *
from fda.regression import ScalarRegression

class TestRegression(unittest.TestCase):

    def test_Bspline(self):

        y = [3.170496, 3.162863, 3.168615, 3.101231, 3.079796, 3.052271, 2.903741, 2.952599, 2.969136, 3.082283, 3.045049, 2.973497, 2.960328, 2.893540, 2.981366, 2.847758, 2.706888, 2.652343, 2.611511, 2.569491, 2.609167, 2.559548, 2.667640, 2.602603, 2.434409, 3.062620, 2.930236, 2.784546, 3.413601, 2.434090, 2.515476, 2.428297, 2.617525, 2.415140, 2.158362]

        x0 = FDataBasis(Monomial(domain_range=(0, 365), nbasis=1), np.ones((35,1)))
        x1basis = BSpline(domain_range=(0, 365), nbasis=65)
        x1coefficients = np.array([[-3.47226935,-4.12302707,-3.4467276,-1.21303734,-5.5114315,-7.6717445,-23.1579052,-13.72184364,-14.9847397,-10.8490052,-10.3883037,-9.05390689,-10.1600572,-6.1934057,-5.5526683,-14.8632838,-18.3053246,-20.7676178,-24.170177,-16.524865191,-20.4535552,-23.15172642,-12.8030614,-8.8914016,-4.60730281,2.4775834,2.962431,-10.9451350,0.7863958,-16.7560345,-27.7366801,-23.2085112,-23.3407679,-25.0389689,-29.65729900], [-3.26637916,-4.58297790,-4.1460407,-1.94262937,-6.1899539,-7.9214086,-21.4158723,-14.95075455,-13.8216701,-11.4012695,-9.8901084,-9.12867690,-8.7346906,-3.5561742,-4.7569655,-11.9478586,-15.8889673,-18.6101565,-26.121923,-12.920320821,-15.1749575,-23.63415049,-11.9708848,-7.0124320,-6.71458251,1.8747273,2.890585,-9.7818307,-0.1281857,-19.7728598,-29.5975420,-27.3694586,-23.5475149,-29.8661207,-32.81546339], [-4.24946460,-7.00508561,-5.6373244,-3.29910816,-8.5584609,-10.8857096,-25.3380862,-15.63839741,-17.4009612,-12.9492214,-12.8163637,-10.60280648,-11.5369087,-8.1825921,-7.2810355,-16.7402119,-20.9800973,-24.9175460,-28.665881,-21.886014236,-24.8321738,-28.97225948,-18.8631975,-16.2648935,-7.87884967,1.2644897,1.941020,-16.3765301,-1.3361429,-20.0834559,-28.3686633,-27.7374558,-27.2815092,-24.6042960,-29.45089474], [-4.95772553,-6.07398338,-5.2195454,-4.00450164,-8.2656450,-10.3423696,-24.6437588,-16.42584865,-16.5522664,-13.6762064,-13.3305344,-11.78776933,-12.4891636,-7.0556666,-6.9179506,-16.0357555,-19.3199597,-22.4525202,-26.317398,-17.066930955,-21.3979173,-28.61933678,-15.9191093,-9.5667938,-4.60705787,3.7438430,4.486262,-9.1304372,1.0799893,-24.6332599,-35.2432669,-29.7497450,-26.3289594,-31.7777296,-33.41553550], [-5.45300180,-8.64207412,-8.0099103,-4.88439500,-10.7539539,-12.7502303,-24.8207517,-18.40409549,-19.4864434,-15.2718882,-14.2787813,-12.93434934,-13.1700724,-9.1324551,-8.9969335,-14.8702058,-17.2057903,-19.2180708,-26.591616,-14.432310623,-17.1211056,-24.06095020,-11.0250744,-6.5606475,-2.66365726,3.7762883,4.064820,-8.0818702,2.5088120,-11.2226698,-22.7604673,-25.8097187,-26.3630554,-29.9524257,-33.02321679], [-4.96060269,-3.95276264,-4.8061315,-1.34987914,-6.3154879,-7.3264702,-22.0749439,-10.79606676,-13.1265425,-10.0385965,-8.3946144,-7.35255718,-7.9404309,-4.2433152,-4.2548323,-13.9698057,-16.8047293,-20.5589898,-26.272942,-14.951273919,-18.4758872,-27.31552604,-11.9018223,-7.1607901,-4.42403762,3.1359431,3.571928,-6.8960090,1.5993438,-18.6360932,-27.5991004,-27.4217339,-26.2509191,-25.5103166,-32.58409920], [-4.10661249,-6.40093221,-6.0379306,-3.51537927,-8.0833744,-9.8749056,-22.8301598,-16.23868656,-16.2649420,-13.2665137,-11.3573036,-11.03773345,-11.9677521,-7.7044819,-7.9973408,-16.1786728,-20.1995362,-23.1711887,-30.335833,-18.004403329,-21.3354820,-30.42556959,-16.2813159,-11.9335541,-4.21911349,3.2897748,3.597416,-11.1712902,0.3420531,-18.5603014,-31.1103631,-31.9458708,-27.4551574,-31.5932330,-33.66106317], [-6.78081992,-8.22213132,-8.5686481,-5.22857223,-10.3992879,-10.7891413,-25.0064402,-15.99626101,-16.5274677,-12.8928170,-13.2490191,-11.40383933,-11.6354531,-7.3320490,-7.3085632,-15.0969846,-16.4316208,-17.5514265,-25.094357,-14.832458974,-16.9018755,-22.76344059,-11.0211189,-5.6202604,-2.73834865,3.8870117,3.995773,-5.1882596,2.9367292,-14.2146189,-25.6885556,-23.7263163,-29.3209250,-28.8730092,-31.73974280], [-4.11901824,-6.16460882,-6.6446683,-3.93735299,-7.9534113,-9.4649555,-21.4398476,-14.56682731,-16.0191517,-12.7490120,-11.9757935,-10.32540845,-10.8292310,-8.6593086,-8.9201365,-12.9457614,-15.8454188,-18.1618264,-26.096698,-12.286633354,-15.5483089,-22.57454221,-10.0865452,-5.4887701,-0.67296693,4.8356040,5.532489,-6.2704778,2.1892239,-12.4113620,-21.9202531,-25.5805716,-24.7134559,-26.6428676,-33.52987507], [-6.18302923,-6.52973154,-7.0279687,-3.47663131,-8.6677619,-8.4482807,-23.1105768,-12.54026163,-13.7297763,-11.1089913,-10.2985547,-8.40961878,-8.7840217,-4.3513495,-4.4705097,-12.1913053,-14.3281825,-18.4157505,-26.553746,-14.095980559,-17.9934149,-25.06402992,-13.7602557,-9.9547269,-0.30885353,5.0014333,4.814417,-6.4700207,2.4020769,-16.6353064,-27.6533078,-27.7655923,-29.1733476,-34.7591168,-32.80978902], [-5.54373766,-4.20947481,-5.7354933,-1.65537288,-6.6938955,-6.9006625,-21.4968306,-10.65833078,-11.4645986,-8.2846020,-7.0049443,-6.08811099,-6.4032607,-4.0788882,-4.0360774,-10.6623901,-13.6720927,-15.3018646,-24.177565,-9.987321912,-12.7824591,-17.33345189,-6.5738572,-1.4622431,1.79318977,5.3257559,5.422894,-1.7319738,3.8239880,-9.1135899,-20.8700500,-21.8394944,-26.1666745,-24.3491470,-33.49927366], [-4.11318768,-5.82550712,-6.2429585,-3.22509804,-7.6127002,-7.5523824,-19.9812265,-10.90933415,-12.9768809,-10.6573174,-10.9780681,-8.54653882,-8.4955718,-5.3643886,-5.5078950,-10.0514994,-10.5320262,-13.8711204,-23.320531,-10.274441524,-12.9214334,-19.08719231,-11.3215348,-8.3229045,0.29876481,5.0853126,4.741263,-6.5964436,1.7358117,-10.4659121,-18.0105529,-19.8489142,-27.6870568,-23.9345876,-33.04222836], [-3.24894386,-2.42058546,-3.7690475,0.03483671,-4.6547764,-3.9904840,-18.3228818,-8.40295958,-8.2922685,-5.2416361,-3.9681146,-3.14952929,-3.5657160,-1.1231098,-0.8334989,-7.6099012,-11.2040219,-12.8277280,-20.981423,-9.455724699,-12.6104695,-18.64318547,-6.4311627,-2.7987663,2.82763863,5.3941577,5.608377,-0.4690863,3.3928046,-11.5899503,-18.9627465,-21.8775098,-24.7752045,-27.0480882,-33.37725903], [-4.64848380,-3.37649958,-4.6122122,-1.63225946,-5.2123227,-4.6822143,-17.6171235,-8.23039864,-8.8295168,-7.4209192,-6.8105057,-4.75328510,-5.1784239,-2.9170251,-2.5124542,-7.1670509,-7.0980237,-10.3974088,-23.248764,-5.575179385,-7.9591323,-15.05774953,-6.7441654,-2.8305539,4.55693319,6.5461787,6.102359,-1.5570469,3.7787339,-4.6788625,-11.3910454,-18.9953345,-26.7285763,-22.9045131,-32.89433818], [-1.70996483,-1.55369455,-2.8430000,0.57406499,-3.0444056,-2.1687876,-16.7925301,-5.33104850,-6.9068912,-4.0200163,-3.6580861,-2.48378561,-2.5366321,-0.3729707,-0.1295860,-4.3782188,-6.5464526,-8.8081666,-18.618307,-4.974302749,-6.9960757,-15.10597215,-3.0701293,-0.4902792,5.53840342,6.9241089,6.833905,0.8558513,3.9778086,-8.0748984,-15.3493139,-17.9673809,-22.3907074,-25.3031244,-30.83367712], [-1.79468731,-0.02003312,-1.2256413,1.40376599,-1.5510013,-0.3946706,-13.1466151,-2.95408687,-3.0471534,-2.4239239,-2.2815159,-0.71713352,-1.1193723,-0.2266671,-0.5229033,-5.0306610,-3.5865254,-7.9279473,-20.092434,-3.219379207,-6.6705790,-14.56729480,-4.7207831,-2.4573009,5.36685741,6.5222566,6.347133,-0.3235591,3.8771446,-5.1022140,-7.8665892,-17.3578142,-24.2554792,-22.1577294,-30.01349068], [0.07407518,0.85332665,-0.2894852,2.04424906,-0.3461414,1.4361722,-10.3639334,-0.71965175,-1.9236248,-0.7737661,0.3916233,2.30763691,1.9505468,3.8639162,4.4419782,-1.1870637,-3.6636184,-6.2289254,-15.190057,-2.590296542,-4.6701189,-8.88482859,-0.5149147,1.0918139,7.30906188,7.3466544,7.435941,2.6224277,4.6058204,-3.1738689,-8.4666394,-12.4637461,-17.5658783,-20.5131640,-27.15246472], [-0.28438190,3.13378000,0.6459162,4.25355975,1.4152649,2.4376976,-9.6761412,0.02187932,-0.6645711,0.3606642,1.8331504,2.71623924,1.9777180,2.9562325,2.4760033,-0.7178319,0.2636696,-2.8254923,-15.700241,1.523912893,-0.5247232,-9.36892030,1.4384727,2.5223161,8.19430823,8.3677549,7.890872,3.9614843,5.3116178,-1.1210625,-3.7869377,-12.2299418,-19.4215572,-18.1622275,-30.13097722], [1.44293648,1.20637153,1.1414142,2.51433115,0.2374252,1.3869209,-10.4010278,-0.17172748,-0.6923887,0.6294272,-0.2253935,2.52578746,2.8334157,3.9582333,4.1414271,1.1889024,3.0634975,-1.1872480,-12.491525,3.500486921,1.3208419,-2.25675567,1.8304585,3.0499592,8.47867705,8.1210759,7.891376,2.9031458,4.8709108,-1.7270202,-3.7179084,-7.9209062,-15.9554640,-18.5566503,-24.72158668], [0.08008628,4.62603760,1.6574296,5.56746031,3.1694946,5.7290775,-6.7963131,5.94101767,5.2886720,5.2493745,7.3038866,8.53525884,8.0872045,7.6511637,8.0454113,4.1708925,5.0142844,1.5327627,-8.991161,4.235801506,3.3218155,-3.46855654,4.3809403,4.7932915,9.59531312,9.0323713,8.557510,5.1095189,5.3236874,0.7534021,-0.9307901,-6.2943292,-17.2206336,-11.6649391,-23.06392179], [2.78862725,4.46691525,3.0606304,5.21979755,3.1755816,4.3574995,-5.5582310,2.70022535,1.8894892,3.8361795,3.5610540,5.65295593,6.2820975,7.2789994,7.6526760,4.3362868,6.4334170,3.5768792,-7.409683,7.498796527,6.0905478,1.42795171,6.1047254,5.8943080,10.64239070,9.3717987,8.686887,5.9250685,6.2871682,1.9758860,1.7488536,-2.4973112,-10.5589460,-11.7528010,-20.47512148], [2.37536345,5.62434193,3.2900996,6.97375430,4.3983096,7.6347339,-3.4162542,8.00257979,7.4132626,8.1088486,9.1393093,10.92889689,10.6055778,9.9285731,9.8731174,5.6424249,6.5194133,3.9606372,-5.211375,6.112069241,5.8400638,3.55102740,6.9166158,5.9703557,11.23398398,10.3671842,9.983211,7.3267346,7.0117462,4.3926516,4.0815507,-0.3518833,-12.3291644,-6.8682372,-18.85221316], [5.34041076,7.34468978,5.9584546,7.33480086,6.4349061,7.4305734,-1.6048484,6.10199134,5.3556576,7.3866334,6.6354619,8.95195965,8.8538611,8.5075497,8.8416568,5.8827597,8.7184020,4.9921868,-5.370467,8.967990652,7.8065643,1.95769240,8.2252454,8.2246540,12.64802533,11.0135827,10.389102,7.9108375,7.5827969,4.2801706,5.4360224,1.3970623,-5.6227141,-3.5623644,-15.44630881], [3.28176795,7.36828640,5.3021310,8.14535938,7.0609248,9.2559964,-1.4139702,7.96683878,7.9103694,9.5586370,9.7368154,12.13015879,12.1327986,11.7280836,12.1211915,7.6827146,9.5789288,8.1014280,-1.631818,9.310356194,9.2869823,6.28306175,9.8987568,8.5086046,13.44910111,11.6133241,10.911988,8.8986644,7.6607970,5.6802894,5.4613415,3.5715359,-7.1527991,-4.9672624,-11.76958566], [7.75155140,10.29680734,8.4807389,10.14091534,9.8194235,11.7937485,3.2392450,12.33600122,10.5322379,11.9219740,11.7313876,13.44365980,13.1557255,12.2654000,12.6904204,9.3095228,11.8651153,7.2863495,-3.060385,12.001831088,9.6890023,5.44537927,9.3907230,9.4121086,13.65387476,12.1393999,11.709668,9.2160558,8.3034706,6.7329852,7.7816949,4.2315014,-2.7899750,-0.3193406,-11.14712818], [5.56176690,10.52993970,8.7837305,10.18420702,9.6440881,12.2005752,0.7421945,11.05953772,10.3303522,12.2653273,12.4098531,14.89023264,15.0492996,14.6922166,14.7698250,10.8691227,13.8377492,11.6502332,1.791342,13.644110341,12.5389694,10.96437779,12.2546772,11.5755271,15.86374940,13.3042481,12.481285,10.7093427,8.8006986,7.1249819,8.6942008,7.8093912,-5.8064297,1.5958094,-10.16968030], [6.63220089,11.37330346,8.6072462,10.49997928,10.5625126,12.4451653,3.3075706,12.62238539,11.5777046,12.6977394,12.2631514,14.63039592,14.6635558,14.0251699,14.4288224,11.1629090,14.6459196,11.5276711,2.273678,13.761167797,13.0456366,8.78365482,12.0426678,11.0456238,14.98367316,13.0236186,12.184201,10.6733458,9.8988681,9.5416716,11.5094529,7.8699777,0.3960318,4.6556723,-6.18452537], [9.94474993,13.17538914,11.6745915,12.31626431,12.7760543,14.8675651,5.6023574,14.27111394,13.5848954,14.8899809,14.6451428,16.72980432,16.3379067,15.7455382,15.6472661,12.5722823,15.7565313,13.0742732,3.928867,14.943047240,13.5679126,13.09743656,13.7961055,13.6256148,18.38740276,14.7712995,13.991393,13.6102432,10.2321143,10.1780225,11.6324619,11.6057604,0.5160710,7.8596259,-4.12770867], [7.95298940,13.32776211,10.5839361,12.08302063,12.2454897,14.2065229,5.5598589,14.15947721,13.6375781,14.5455298,13.4670769,16.34378254,16.9830663,16.8679350,17.5658197,12.9610561,16.1844139,13.3220576,3.212292,16.601176943,14.8454638,9.69278884,13.8335246,12.9028300,16.71624542,14.4569841,13.537529,11.8696096,10.0621205,10.8540281,12.7278689,10.4799096,1.5813731,8.5093407,-2.81115335], [10.36037834,14.07602075,13.0152496,12.89955344,13.8276863,16.3226024,7.6039964,16.26630432,15.5707159,17.2464623,16.2878734,18.46768600,18.2009371,17.9923942,18.0668651,13.6597506,16.1656638,13.9894556,6.381379,15.094620073,14.1063668,13.93774341,13.7476588,13.2985518,18.41391844,15.2054300,14.328058,13.5243290,11.5394049,12.7047158,14.2949071,13.8701586,3.8881370,12.5414838,0.03698253], [13.47850733,16.92666848,15.3935043,14.57903161,17.1674107,17.7221325,10.7265562,17.48829017,17.0370324,17.3153677,16.6020366,19.00109146,18.8311194,17.3119444,17.5059949,13.7594293,17.1248747,16.1337843,7.830939,17.194190575,16.0945118,13.88117480,15.1482737,15.0994684,19.74684128,16.2103856,15.398354,14.0989721,11.1427447,11.3082150,14.0166567,14.0167336,3.7430347,11.8399283,0.61241066], [11.31107280,15.81043104,14.4957744,14.67838726,15.6159496,17.5971764,10.9851155,17.20852704,16.5111542,17.5179530,16.1379163,19.23089090,19.0196816,19.2889282,19.1579313,15.8425635,19.2500009,15.9313145,8.416428,17.826295041,16.4592620,15.33651183,14.2924235,15.0004302,18.77084949,15.3332950,14.386413,13.2126534,11.6359416,12.9261776,14.1209284,14.8367700,6.0016556,11.6242580,2.34870708], [14.04077876,16.90183801,15.4034916,15.24308992,16.5426919,17.9209480,10.3208849,18.15180140,16.9491681,17.7854868,17.1782350,19.70271761,19.8703106,19.1170352,19.6069606,16.0217570,17.9879243,17.6626595,11.265670,17.343334770,16.7174945,16.52088255,15.1506242,14.4410730,18.27433229,16.3213484,15.564584,14.0150659,11.8660692,13.1885469,15.4440148,16.6911346,6.4148856,13.9292708,2.72922471], [13.96011197,17.84660143,17.0868684,15.27698503,17.7629277,18.7257644,12.9619711,17.82269762,17.5178648,18.9016657,17.6344468,20.68491314,20.9394711,20.9067158,20.4893552,18.5216051,20.7195880,17.5025491,11.373626,19.876235249,17.9951314,16.72156595,16.2471478,16.8509148,20.54831743,16.6376503,15.171128,15.6363318,13.2080030,14.4562625,15.6210306,15.8801863,6.9191446,13.6533756,4.71961799], [16.15444153,18.40615832,17.4634452,16.83699108,18.4550642,19.4809814,12.9891387,19.55394652,18.4204521,19.0658287,17.9493436,20.60469503,20.7358576,20.2022430,19.8796224,16.3213001,19.1489248,17.1945481,10.426024,18.111273405,16.7216877,15.63995165,15.5984532,15.5885422,20.29022940,16.8172937,16.381992,14.6084508,12.4339449,13.9482513,16.7472168,17.3519630,8.0507257,15.3977248,4.11916559], [15.28101549,19.48442345,18.4222192,16.58208190,19.0799147,20.4034546,12.3876589,18.59522147,18.1926051,20.0375376,19.1972522,22.06868950,21.8224347,21.9895256,21.6848358,19.2000728,20.3852790,17.8904308,14.053057,19.475717831,18.2568270,16.78706727,15.9400998,16.3474949,20.99706398,17.6615402,16.685725,15.7189565,13.4281759,14.1127217,14.7971319,16.2040310,7.4275184,13.7240786,5.19892681], [15.69065152,18.75547526,17.9915958,17.12135898,18.8208881,19.3166517,12.2036690,19.74584158,18.8212806,19.3681299,17.9126755,21.11940493,20.8732016,20.5117654,20.2076243,17.6172724,19.2698906,17.9560228,11.551862,18.819552959,17.4652208,15.20294296,16.2988245,16.9945964,22.70444597,18.4290770,17.233053,15.8257581,13.0700583,13.6455364,15.0308775,16.7162943,9.5593400,13.2093229,3.70752628], [17.15001985,18.92746695,19.0748894,16.69799225,19.4564126,19.3965989,13.4321683,17.95050223,17.7025542,19.0903596,18.1798292,20.78658305,20.0852676,20.1076003,19.7408712,17.5312490,19.3965073,17.6408784,12.949360,19.267045103,17.3384211,16.44940610,17.0106776,17.2081026,22.28153799,17.9577981,16.596134,16.7169342,13.6946264,15.1131458,15.8989938,16.5692258,7.2831190,14.1153238,3.73424425], [16.23998729,19.76720433,18.5713082,17.66807554,19.2812512,20.1135583,11.8584419,18.66032516,17.5408604,18.9662330,18.1955621,20.98180072,21.0314424,20.5809283,20.2120311,17.6834397,19.1064222,18.3748167,11.259717,19.355017115,17.8459498,16.84927921,17.0056802,17.2961419,21.76814278,18.1896366,17.012443,16.1325775,14.0468356,13.3314775,13.8639636,16.5299751,7.7101595,11.4653459,3.27867569], [16.12794099,18.62645203,18.5889813,16.76488634,18.8051878,18.8448372,12.3499137,17.99374553,17.6427983,18.0840357,17.0743928,19.55967307,19.2094396,19.4899009,19.1091205,16.9168156,19.1695810,16.7506031,13.028893,18.643615656,16.4279645,14.49969338,15.1507141,16.0619212,21.32820615,18.3937492,17.275590,15.8386912,13.5359559,13.7323169,13.5960777,13.9477998,7.6804502,11.7341004,2.43661274], [15.64387040,18.40866364,17.9221674,16.83131354,17.9322092,18.3986046,10.2827070,16.93911381,15.5361702,17.5066819,16.4644769,19.11144408,19.0954613,19.0212898,19.0049135,15.8189698,17.2567711,15.7802607,10.569367,17.667966126,16.3161177,14.91411044,15.5134753,15.5266101,19.80093781,16.9256502,15.576580,14.4846408,13.1863707,12.4177482,12.6791919,14.4827761,6.5688777,11.3674291,1.53545570], [12.79359620,16.23170135,15.5667973,15.21882185,15.8977837,16.1137038,9.9804339,14.63165015,15.2759933,15.8658965,14.5673649,17.57734483,17.5553506,18.6358643,18.6035690,16.3289844,19.1834835,16.4837955,11.604999,18.112800002,15.5488114,13.60014137,13.0722930,14.6448919,19.20124459,17.0284389,15.809294,12.6280466,12.8047561,10.7134301,11.0747193,12.8739780,6.5714528,9.0752035,1.10550596], [15.08516028,17.90006711,16.9448624,16.75246953,17.3658120,17.7740393,8.5004046,16.60187794,15.4982832,17.1825619,16.5865167,19.32721384,18.9354925,19.4891941,19.1172913,14.7509607,15.9151419,13.3530649,9.383003,15.276232027,13.5469180,11.06689384,13.3730589,13.4129192,17.79747334,16.2280456,15.459368,13.3788151,13.0199172,10.5572005,9.6329370,11.3170225,4.6762655,7.6006416,-0.79905241], [10.78289690,14.47669158,13.8238349,14.22815022,14.1748350,13.9237242,8.6794818,14.18556801,12.8436996,14.4271252,13.1989687,16.32627553,16.4047091,17.1963066,17.5517647,14.8077176,16.2256640,12.6032681,7.721803,14.927549353,12.7243074,9.48818538,11.8489597,13.0953215,17.84982374,16.0778327,15.196319,11.5995204,12.1608256,8.1743178,8.1160990,8.0798914,4.9026390,4.9371922,-1.21718016], [13.99273754,15.50079467,14.9949921,14.93749192,15.0021221,14.7899618,5.7749761,13.55375583,12.7265629,13.7577699,13.1902275,15.87948238,15.7716376,17.0053990,16.6843186,11.4158422,12.0558886,10.4797533,6.043461,12.084568801,10.2639706,7.72879852,9.9039655,10.2334800,15.00236833,14.6244534,13.990736,10.0876059,11.8353169,8.2420726,6.7594788,7.3738997,3.3528117,4.9267821,-3.72972257], [10.06200774,12.68446041,11.9690108,12.59243890,12.1598482,11.8617838,4.8832306,10.02672006,10.0419269,11.7653119,11.6248196,13.88519017,13.4475422,14.3819129,14.7652603,11.4433178,13.0217375,10.3340757,6.499276,11.618437418,10.2272854,8.45274256,9.7668102,9.9811098,15.19667146,14.3079556,13.791435,9.3698499,10.8156373,7.9405528,7.8982466,8.0894615,2.0187616,4.9836398,-5.09599482], [12.42557107,13.69006443,13.3810861,13.58810625,13.3593090,12.3241962,4.9797237,11.92330807,10.4580388,11.8202987,11.0180479,13.54418412,13.0921786,14.2968139,14.1485108,8.7477045,9.3914968,7.6969052,3.816280,8.950168951,7.7238879,5.11928599,8.8499366,9.8183456,13.37678680,13.1822331,12.913094,9.6381528,11.1053389,5.4844602,3.0086682,4.5170500,1.0131850,0.1655786,-6.63329227], [9.44780752,11.67777673,11.1595699,11.45592375,11.3407007,10.6600115,1.4960054,8.69990197,7.6467360,9.0586306,9.2832487,11.41895937,10.8415629,11.3491082,11.5185148,8.2885222,9.7320581,7.0680880,1.671535,9.819136785,7.9740234,4.69991069,8.6763420,9.6369055,13.18475449,13.3488565,13.044499,7.8535190,10.1596375,5.2031461,2.9933094,3.9422158,-1.1822174,-0.4132347,-9.90814058], [9.39043577,10.94192260,10.6960418,11.77340371,10.4480535,9.8238850,0.6867065,8.04249841,7.2698812,9.5964186,8.9367242,11.01813080,10.5003052,11.4080792,11.7093164,7.1883869,7.9193858,5.5084212,1.065715,7.266047366,5.8817304,2.51975214,7.8075338,7.8691096,10.81320895,11.1575851,10.773591,7.4466548,9.8080261,2.7868908,0.2950122,1.3185188,-1.7257130,-3.4425979,-9.56914592], [8.01178542,9.04214861,8.9256799,9.24991444,8.7088851,7.4847627,0.4679703,6.87163726,5.7714836,6.3711553,6.0309892,8.33577412,7.7804622,9.4062981,9.1793003,6.4858308,7.0481253,5.1526448,0.654530,6.509578369,6.0674788,3.30286949,6.2532573,7.9582931,10.30007498,11.6994062,11.561345,6.1575390,8.9128411,4.2115341,0.7321533,2.4134667,-3.0694999,-2.6654362,-14.11745894], [6.70396945,8.34282585,7.9767053,9.31930293,7.8859203,7.4284277,-1.1840168,6.39961910,4.8334819,6.9432525,7.1609281,8.73660367,8.6738985,8.8613907,9.6000808,5.0414683,4.9572673,2.9891769,-2.278423,4.900125819,2.9457291,0.01645074,4.2200297,4.3201229,6.72049032,8.6247332,8.441946,3.5066799,7.1129361,0.2935737,-4.5729094,-2.8546655,-3.5243683,-9.8189285,-14.21245958], [6.14896945,7.72286509,7.7987322,8.31789462,6.9760608,6.6089520,-3.5995742,4.68831967,4.4133096,5.5657862,5.7459270,7.46267791,6.7080525,8.2557840,8.0278100,3.8852753,4.9137235,2.8520594,-2.107654,4.377519713,3.6922091,-1.03899512,3.8202570,5.7998064,8.57824177,10.0133692,9.866610,4.8246666,7.9846629,-0.8123301,-7.7006866,-2.2481007,-7.4548679,-10.3211006,-18.08823068], [4.96772535,6.26474216,5.8146683,7.79571183,5.9419961,5.0335052,-2.9789522,4.07393708,2.7225232,4.1376575,4.1878076,5.82289813,5.5493598,6.4895800,6.6995017,3.8372869,2.7270333,0.3629099,-4.915187,1.852587597,-0.7226985,-2.42844406,0.1458071,1.5736269,5.77525450,8.2156388,7.708862,1.7420744,5.7478815,-3.6457478,-9.1510823,-5.8591740,-7.9301543,-14.1171808,-18.90632863], [4.92384866,6.38167282,6.4305248,6.99305653,5.8715601,4.7877773,-5.8851950,2.61816061,2.0261661,3.1965992,3.6241719,5.70969292,5.3333796,6.9578350,7.3324076,1.8301880,0.8898593,-1.8213249,-6.853284,0.001646043,-1.4870871,-5.20716549,0.4230321,2.1330794,5.05490385,7.9248330,7.859559,1.0336071,7.3191185,-5.2532804,-12.9757178,-8.3131788,-9.0634003,-17.2805262,-20.64795819], [3.96407914,4.71065095,4.3080118,6.43604546,3.9173842,2.8902435,-6.0531055,1.72126902,-0.4912465,1.2586537,2.2547166,3.35523779,2.0786009,3.4590790,3.4619226,-1.9597608,-3.9918481,-5.9963992,-11.016791,-3.687180051,-6.0105318,-10.35183414,-5.2703551,-2.4203892,2.67592884,7.2207322,7.171602,-2.0010464,3.7642048,-8.5436299,-13.9537370,-12.4567002,-10.4213426,-18.3215561,-22.63702162], [3.61404935,3.10552156,3.7882917,4.70153038,2.7536109,1.2026077,-10.5849087,-2.51844943,-2.7636949,-0.4980151,-0.6945128,1.27459509,1.1848413,3.6227119,3.5483347,-2.2777595,-2.6964233,-4.8344045,-11.136695,-2.676585930,-4.4787300,-7.96256336,-2.7890556,-0.9226786,3.32245791,6.1738905,6.126539,-0.9169530,4.6324861,-9.3273222,-18.8143571,-12.0028873,-12.8814232,-19.8154777,-24.70115158], [1.20389635,1.35963275,1.9539900,3.22272399,0.6969988,-1.0848004,-9.4023618,-3.14035383,-4.2519269,-2.3740260,-1.7769336,-0.30224286,-1.0101960,1.2902209,1.6925426,-3.3843618,-6.8924891,-10.5917859,-14.943662,-7.702276113,-10.7431091,-15.87038426,-10.1340890,-6.6590733,-0.02827618,5.4667604,5.489291,-6.1010760,1.9533186,-13.7567048,-21.0156906,-19.9199107,-13.4152879,-24.6938089,-25.29142137], [1.97430446,1.64103847,2.2615271,4.02776982,0.6716980,-0.5613943,-13.1318340,-3.16649724,-4.8896414,-2.8625090,-2.2044736,-0.07240792,-0.7719204,2.8236704,2.2188172,-6.2926418,-9.7179623,-13.6609624,-16.610605,-10.048308051,-13.1904432,-18.06822657,-8.3097435,-5.6319387,-2.00153301,3.3523849,3.595994,-5.7210721,3.5740717,-10.7183980,-20.0035235,-18.6790645,-16.4409728,-27.5979646,-28.15301110], [-0.05243898,0.44574724,0.6184050,2.04369706,-0.4364942,-2.6847713,-13.6583680,-5.81638868,-6.6399419,-4.9679900,-4.0517668,-2.95764245,-3.7983902,-1.9636684,-1.4990582,-8.8622091,-11.1604961,-13.2289911,-19.261660,-10.394073226,-12.7112300,-16.43788178,-10.7832181,-6.1363436,-0.93562015,5.1135213,5.235177,-6.4565751,1.8122679,-14.1102531,-25.0830862,-19.8034053,-20.6518419,-22.7562888,-26.91212448], [-0.86600018,-1.91910534,-0.7710663,0.56846325,-3.1323055,-5.6916354,-17.3258726,-9.09444163,-10.0239163,-7.4337484,-7.7800294,-5.67543978,-6.3869941,-1.3676656,-1.6552448,-8.9381856,-12.5047276,-17.4041233,-21.546876,-12.438651712,-16.6830542,-23.32830143,-11.7667705,-8.8113593,-2.47290937,3.6241662,3.797163,-7.8063480,2.4575019,-18.2046602,-26.8233763,-26.4932049,-20.5733666,-29.6131413,-29.33262202], [-2.36681521,-2.28709635,-1.8696157,0.36984720,-3.4646697,-5.4388369,-22.0778966,-10.93681672,-12.4414012,-8.6085119,-6.7665983,-5.49997859,-6.4099822,-3.3492713,-3.2421660,-12.0344871,-15.4417533,-18.8599383,-23.843647,-13.268093879,-16.6119621,-22.98511491,-10.9683242,-5.0338466,-1.49800348,4.2612196,4.379706,-5.1570193,3.2951969,-11.9672283,-23.8122820,-22.2766458,-24.8000403,-25.3475608,-28.94824717], [-2.22202954,-6.01003696,-3.4194820,-3.57855162,-6.4891505,-10.0246229,-21.0748796,-15.81201371,-14.6861033,-11.7707553,-11.6690969,-10.15682677,-10.6388549,-4.1848082,-4.3385541,-10.6883512,-14.0571422,-17.3078938,-22.508033,-14.496587509,-17.4244243,-20.51630999,-13.7884742,-10.8110716,-4.73169849,2.6897291,3.325409,-11.4132849,0.5194959,-17.6908346,-25.2216513,-24.2618054,-21.7975819,-24.8938772,-29.20356636], [-1.99789179,-2.35686639,-2.4379416,0.77563101,-4.5679244,-6.1146924,-21.2243009,-9.55365057,-12.1823680,-8.5695650,-6.8129885,-5.64331998,-6.4717129,-4.6993326,-4.6474165,-15.0633070,-18.7391812,-20.5460257,-25.953251,-13.523940142,-17.1322568,-26.18912109,-10.1002041,-5.5574602,-2.30527988,4.2627107,4.591206,-5.0209158,3.3079860,-14.7589635,-24.9075085,-25.9240261,-23.9952065,-28.6793716,-31.15436023], [-3.63233304,-5.67695663,-4.6308154,-3.16248368,-6.9785392,-9.5818580,-22.6455082,-14.83908584,-15.7423369,-12.9798345,-13.0307011,-11.85702197,-12.7730906,-5.5387227,-5.5124144,-12.9141375,-15.2780961,-18.9509330,-23.509464,-16.778341025,-20.7558574,-23.56480091,-16.2670208,-12.1965631,-7.95351219,0.6510945,1.785466,-14.0185199,-1.4558668,-18.4388269,-27.5324776,-25.1714936,-22.9421665,-24.4895386,-28.18800137], [-3.89561940,-5.19735839,-4.1212035,-2.02522091,-6.2662870,-8.9261642,-21.8459764,-13.35132436,-15.2587448,-11.5253093,-9.5662205,-8.27946771,-8.6474265,-4.9232097,-4.8407829,-14.3521569,-18.7858970,-21.7140720,-26.090517,-17.079833142,-19.4892870,-22.90887280,-12.7777684,-9.4750011,-5.92622484,2.5388369,3.150377,-10.9882030,0.4669286,-15.9150718,-27.1891180,-25.2082659,-24.9632931,-24.4061756,-30.99918375]] )
        x1 = FDataBasis(x1basis, np.transpose(x1coefficients))

        beta0 = Constant(domain_range=(0, 365))
        beta1 = BSpline(domain_range=(0, 365), nbasis=5)

        functional = ScalarRegression([beta0, beta1])

        functional.fit(y, [x0, x1])

        testing.assert_allclose(functional.beta[1].coefficients.round(3),
                                np.array([[- 0.0034528829, 0.0010604239, 0.0002112618, - 0.0020050827, 0.0051286620]]).round(3))

    def test_Fourier(self):

        y = [3.170496, 3.162863, 3.168615, 3.101231, 3.079796, 3.052271, 2.903741, 2.952599, 2.969136, 3.082283, 3.045049, 2.973497, 2.960328, 2.893540, 2.981366, 2.847758, 2.706888, 2.652343, 2.611511, 2.569491, 2.609167, 2.559548, 2.667640, 2.602603, 2.434409, 3.062620, 2.930236, 2.784546, 3.413601, 2.434090, 2.515476, 2.428297, 2.617525, 2.415140, 2.158362]

        x0 = FDataBasis(Monomial(domain_range=(0, 365), nbasis=1), np.ones((35,1)))
        x1basis = Fourier(domain_range=(0, 365), nbasis=65)
        x1coefficients = np.array([[89.59970707, 1.174930e+02, 105.26055083, 1.301337e+02, 99.96350074, 1.005497e+02, -96.65546155, 59.2254168, 42.91552741, 77.96399327, 78.70202100, 117.12657116, 1.110496e+02, 138.82249275, 1.397123e+02, 47.02963944, 47.24424325, -2.889300e+00, -135.38359758, 5.245231e+01, 1.303849e+01, -65.12440445, 4.312490e+01, 76.1634150, 1.671345e+02, 190.26983010, 183.86312129, 73.26888068, 133.787154614, -1.627325e+01, -91.52590710, -95.97501045, -184.4127164, -176.52995213, -315.58275141], [-74.67672652, -7.574673e+01, -85.15643810, -6.601327e+01, -83.87111523, -7.021954e+01, -98.06174409, -76.5849625, -75.88594192, -73.32390869, -67.46233198, -71.17436876, -6.956544e+01, -68.33940763, -6.726469e+01, -71.48143615, -72.30647547, -7.684052e+01, -118.51218788, -6.220087e+01, -6.383014e+01, -84.94995574, -4.925358e+01, -45.6051376, -3.423479e+01, -30.51656702, -28.94391617, -34.56452012, -32.633211110, -4.503430e+01, -50.22893925, -95.51811954, -121.8774966, -98.96479038, -111.60883417], [-115.17887797, -1.497403e+02, -137.09440756, -1.190519e+02, -158.92545942, -1.816266e+02, -221.18086933, -211.4821603, -213.56471876, -200.18276086, -188.11022053, -197.33164610, -2.013817e+02, -170.81595630, -1.706599e+02, -202.60357163, -244.23067752, -2.491603e+02, -239.12452551, -2.306004e+02, -2.438912e+02, -274.86941043, -2.007684e+02, -168.3679298, -1.650695e+02, -92.64319338, -82.89600682, -162.32212326, -75.031989426, -2.089919e+02, -296.89430969, -286.83141439, -211.1464896, -285.79300980, -233.47281556], [5.53204090, -1.130089e+00, 0.52842204, -2.529557e+00, -4.33875191, -7.285767e+00, -9.34989482, -17.3517982, -16.79521918, -13.16131373, -15.10706906, -13.64492334, -1.336251e+01, -6.68886249, -8.759763e+00, -8.59849662, -13.83778943, -9.999166e+00, -3.73673987, -7.144765e+00, -1.224332e+01, -16.78243867, -5.401828e+00, 5.1018233, 1.184882e+01, 12.73523631, 11.89294975, 6.34183548, 10.595544948, 4.244354e+00, -5.78542095, -8.64259411, -9.1706692, 11.14716776, 12.06788481], [4.23416905, -1.094302e+00, 4.44785457, -3.921093e+00, -0.46197323, -6.632285e+00, -7.90683222, -14.9542548, -14.60033008, -9.01383237, -10.77893449, -10.04422090, -1.041400e+01, -3.44100999, -4.604680e+00, -17.36428915, -23.90220629, -2.296112e+01, -10.33599114, -2.145569e+01, -2.587159e+01, -20.52740621, -2.002035e+01, -12.1712595, -1.408536e+01, -1.86240728, -1.03630630, -18.06265481, -4.271425424, -2.053210e+01, -27.49771490, -7.17812126, 6.7410286, 23.62586533, 33.97943929], [-8.77771637, -7.837793e+00, -10.51503459, -5.876606e+00, -9.53902590, -8.950795e+00, -7.96775217, -9.2985688, -10.19042451, -6.61918797, -6.94284275, -7.38161195, -6.848871e+00, -7.05336990, -5.656784e+00, -9.45126385, -4.11766735, -2.002758e+00, -0.96182170, -2.999917e+00, -3.405476e-01, -0.29258681, 3.696487e+00, 2.0932434, -6.022455e+00, -0.15923433, 1.07208902, -1.79542350, 1.574204102, 7.547922e-01, 0.52053437, 5.80414816, 4.3150333, 17.10460123, 9.71564993], [-1.51415837, -2.946328e+00, -1.19506263, -7.124769e-01, -3.57660645, -5.908690e+00, -9.60105427, -8.8099624, -7.68376218, -5.01335967, -4.13543242, -3.76125298, -3.824409e+00, -0.58156824, -3.714378e-01, -5.37422048, -4.73805333, -8.651536e+00, -4.32810391, -3.306290e+00, -4.078670e+00, -6.74524954, -2.018126e-01, -2.8466987, -4.840585e+00, -0.69245669, -0.03545445, -6.60561886, -1.478619562, -5.844820e+00, 1.97271926, -4.13375283, -0.6109633, 4.50542683, 4.00067677], [3.19273792, 1.010561e+00, 1.50781048, 6.207182e-01, 1.26263576, 1.667300e+00, 5.33530014, 2.2976652, 2.18630617, 1.78337371, 2.96173905, 2.06155580, 2.046629e+00, -0.67518222, -1.207833e+00, 3.77542026, 4.80544821, 7.294024e+00, 8.88106241, 5.367792e+00, 8.790006e+00, 8.46637718, 7.963180e+00, 5.9721721, -6.686825e-02, 0.29232727, 0.40864262, 2.66183732, -0.037728177, 1.589603e+00, 1.42045600, 7.86628306, 6.3373820, -0.97133252, -0.09477871], [0.93816015, -1.110971e+00, 0.54196299, -1.461903e+00, -0.84095617, -2.490436e+00, -3.05602692, -3.4011579, -2.51379321, -3.60579532, -3.38203972, -3.76048310, -3.974735e+00, -1.84245223, -1.396258e+00, -3.15492736, -3.05960088, -3.599763e+00, -2.79276108, -3.379715e+00, -2.539994e+00, -3.44772241, -2.340569e-02, -0.8692101, -4.452914e+00, -3.49084735, -1.64765581, -3.77231123, -1.698689830, 1.716089e+00, 8.19121224, 0.52454112, -2.3580422, 8.36202710, 1.43949676], [-0.32883231, 1.819621e+00, 1.00113530, 1.192337e+00, 1.26104761, 2.671245e+00, 3.85644781, 3.3667360, 3.81137706, 1.41261695, 1.71090156, 1.05317196, 1.265023e+00, 1.17510383, 1.676179e+00, 1.22953838, 2.97153947, 2.446238e+00, 0.12602771, 2.270051e+00, 1.120319e+00, -2.38128173, -1.344594e+00, -1.0704945, -1.093017e+00, -0.25113863, -0.48307419, -1.73251272, -1.461257822, -4.698930e+00, -3.90412925, -3.58681205, 2.7387934, -4.72929209, -2.56319254], [0.11601629, 7.660468e-01, 1.50644743, 8.912022e-02, 0.96960619, 1.185724e+00, -3.52462967, -1.2475196, -0.97024300, 0.11505421, -0.12691757, -1.02443267, -1.297848e+00, -1.49376148, -1.013824e+00, 1.17623160, 1.68671168, 3.243256e+00, 0.77789688, 3.327439e+00, 2.786415e+00, 3.41517012, 4.363606e+00, 3.6867715, 2.580380e+00, 1.01183401, 0.89280618, 2.53820860, 0.245348118, 2.748592e+00, 4.03296208, 4.84482840, -0.4626386, 5.75765047, -0.95966081], [1.85054290, 1.655562e+00, 1.48548487, 1.725964e+00, 1.73480788, 1.729848e+00, 2.52923882, 1.1428430, 0.38652710, 1.31141257, 1.44514759, 1.68859090, 1.435771e+00, 1.38363500, 1.634005e+00, -0.29474860, -2.29333598, -3.291515e+00, -1.79756811, -3.803962e+00, -4.081570e+00, -6.87963706, -4.705254e+00, -4.5381878, -1.496349e+00, -0.64357831, 0.04523418, -3.18568596, -1.597410425, -5.711994e+00, -3.26221352, -4.96024097, 2.4892142, -3.47805988, -0.98560047], [-1.92514224, -1.901784e+00, -1.97326589, -4.851519e-01, -2.18719545, -1.403135e+00, -0.22178334, -0.8665782, -0.48234355, 0.41499621, -0.34390321, 0.40307443, 1.644554e+00, 1.81715202, 2.610074e+00, 2.60035175, 2.19658230, 2.930277e+00, 4.80050417, 5.501741e-01, 1.439555e+00, 6.59164448, -2.342761e+00, -3.0053935, -3.550229e+00, -1.55360864, -1.46798140, -4.04960581, -1.591418235, -2.246921e+00, -0.61547511, 5.15601818, 1.9540730, 4.17039396, 2.36170647], [1.00374756, 5.684724e-02, 0.54922198, 5.055470e-01, -0.20610074, -5.449527e-01, 0.72483725, -0.5773061, -0.43579344, -0.36483489, -1.02388369, -1.12723853, -1.187680e+00, -2.11135729, -1.352816e+00, -2.71631074, -2.89474411, -1.125570e+00, 0.11786105, -2.422268e+00, -1.166742e+00, -0.27168351, -1.031490e+00, -1.2818386, -6.442153e-01, -0.32753027, -0.56083303, -1.34982703, -1.382271157, -1.943469e+00, -0.94881097, 0.89495146, 0.3965252, 2.60077158, -1.76550223], [0.52399639, -5.655853e-02, -0.27545732, -1.692510e-01, -0.40510831, -6.253891e-01, -2.18746609, -0.1664321, -0.07768066, -0.20619656, 0.12224883, 0.51634225, 5.523473e-01, 1.03214516, 8.086379e-01, 0.76901682, 0.15913825, 9.792238e-01, 0.85253148, -5.696796e-02, -5.626048e-03, 4.10350760, -1.963309e-01, -1.5263529, 1.032630e+00, 0.48482088, 0.79333156, -1.44946223, -1.268912266, -1.445311e+00, 0.29633510, 2.79746146, 1.8796945, 3.16943020, -0.29738563], [-2.87812864, -6.006869e-01, -1.33765878, -2.417520e-01, -2.21109056, -1.153842e+00, -1.51620001, 0.8903456, 0.11331808, -0.22120068, -0.52819274, 0.46153320, 1.546802e+00, 2.02515279, 2.173945e+00, 3.14379916, 3.51831883, 3.711914e-01, 2.28610877, 1.382766e+00, 6.722253e-01, 1.50799242, -1.736528e+00, -1.4909560, -3.032066e+00, -1.56979669, -1.60074429, -3.32896128, -1.702777138, -2.492388e+00, -2.85806959, -0.10840979, -1.2144304, -1.44284038, -2.47567087], [1.89403282, 3.387828e-01, 1.24981784, 1.476913e-01, 1.14470343, 7.248325e-01, 1.50316611, -0.5275552, -1.31309783, -1.28942861, -1.60728285, -1.37361611, -1.544886e+00, -1.80749183, -2.172358e+00, -1.10586476, -0.59817961, -4.357982e-01, -0.29983525, -3.155637e-01, -8.046187e-01, 2.83630772, -1.069000e+00, -1.5967138, -2.789890e+00, -1.19528112, -0.53442548, -3.30897780, -1.690758341, -2.138268e+00, -1.28369621, 0.26577967, 3.0773312, -2.23526053, 0.83412752], [0.12823011, 4.993544e-01, 1.02232557, 5.454701e-01, 0.94056174, 7.283190e-01, 2.25588692, 1.9841030, 1.43314246, 0.60976371, 0.15388345, 0.94202703, 4.802331e-01, -0.17118836, -1.733193e-01, -1.03902610, -2.31585595, -2.447040e+00, -1.18451441, -2.633862e+00, -3.619202e+00, -1.67590327, -2.588952e+00, -2.3208547, 7.518609e-02, 0.09311304, 0.26970617, -1.80552037, -0.690402996, -2.429605e+00, -5.03001842, -1.50444070, -0.1540092, -5.42013467, -1.10619136], [-0.05352199, -1.036108e+00, -0.77861023, -8.623670e-01, -0.52701735, 1.376449e-03, 1.30578341, 0.1081651, 0.61644607, 0.85691395, -0.76405502, -0.10679753, -1.110967e-01, -0.01503466, -2.454475e-01, -1.07275143, -2.25988039, -2.137842e+00, -1.16810626, -2.641343e+00, -1.978049e+00, -3.19345586, -1.675475e+00, -2.7590442, -1.614353e+00, -1.07275092, -0.31712193, -2.90996441, -1.819662986, -9.108038e-01, -0.44814903, -1.32223011, 4.2705897, 0.10411349, 3.04871719], [-0.63707827, -5.423252e-03, -0.54238986, -5.753046e-01, -0.81002822, -1.812182e-01, -0.72637652, -0.7321933, -0.41937328, -0.89267560, -1.67907984, -1.18129800, -7.633840e-01, -1.11395939, -1.093883e+00, -1.06157417, -1.22123165, -2.262188e+00, -0.23249279, -1.839265e+00, -2.414006e+00, -0.96824711, -1.426166e+00, -1.5246675, 7.014345e-02, 0.34850332, 0.43894888, -0.23563895, 1.003669242, -1.372659e+00, -2.48476002, -0.59369763, -1.4040417, -1.47627477, 1.32651061], [-0.20519335, -6.796379e-01, -0.84645502, -6.354323e-01, -0.74690188, -1.535576e-01, 0.60201689, 0.4156856, 0.42217671, -0.38500919, -0.16557109, -0.43869472, 1.994074e-01, -0.17451086, -1.450471e-01, 0.82473756, 0.83877575, 2.156601e+00, 2.14167561, -2.533763e-01, 8.100568e-01, 2.62674991, -1.358064e+00, -2.0745544, -3.546144e+00, -2.17179370, -2.02087092, -3.13800540, -2.179375003, -3.729858e-01, -0.61674094, 0.02363170, -0.7285647, -1.44872242, -0.33539413], [-1.51120322, -4.099126e-01, -0.70199290, -6.264074e-01, -0.14881164, -3.453822e-01, -2.60262828, -0.4963166, -0.52966599, -0.66123536, -1.58556674, -0.50794510, -9.947995e-01, -1.62037425, -1.196887e+00, 0.14784939, 0.78732258, -9.451537e-02, -0.58266866, -5.885843e-04, -2.225741e-01, -0.57161583, -1.001126e+00, 0.6662864, 1.338666e+00, 1.15763642, 1.09746517, -0.96427466, 0.289711918, -4.878167e+00, -4.79903309, -2.16201221, -4.1199779, -5.17516190, -0.15596139], [0.93772191, 1.434060e+00, 1.46562976, 1.027022e+00, 1.83216687, 2.017265e+00, 1.90922438, 1.2976072, 2.32440414, 1.72987293, 1.43640559, 1.07796853, 8.040374e-01, 0.55450693, 6.050737e-01, -0.73772029, -0.67653405, -5.558536e-01, -0.25247028, -1.500706e+00, -1.225158e+00, -1.12798080, -2.164946e+00, -1.9261836, -2.691497e+00, -1.54005768, -1.18751473, -3.32269485, -2.214593325, -1.897016e+00, -2.33774458, 0.24093075, -0.6937826, 0.17557079, 0.11115402], [-0.06481706, -1.659918e+00, -1.09388609, -1.905815e+00, -1.40679309, -2.245890e+00, -2.23589487, -4.0863735, -3.36119968, -2.54672686, -3.88066869, -3.21323873, -2.951304e+00, -2.81616882, -2.428936e+00, -1.62115870, -1.99948070, -1.944861e+00, -3.54284799, -1.526877e+00, -1.411713e+00, -2.22639667, -1.269234e+00, -0.8733168, -5.888535e-01, 0.43988955, 0.61095815, -0.66937536, -0.194240531, -2.201345e+00, -1.89931801, -1.99023634, -0.9309564, -0.06164975, 0.63689323], [1.29314791, 2.216558e+00, 1.21082603, 2.301156e+00, 2.10492772, 2.058904e+00, 3.39057323, 2.5114900, 2.20853034, 1.45677856, 1.73899204, 1.80547990, 1.249289e+00, 1.11284238, 7.591423e-01, -0.35480926, -1.60016245, -1.093994e+00, -0.73575426, -2.399513e+00, -2.037750e+00, -0.61682787, 1.962567e-01, -0.7811619, -2.499574e+00, -1.19537245, -1.32052778, -1.14084857, -0.305790921, -5.422355e-01, -0.57154810, 0.87568897, 1.1479541, 1.99979013, 0.30593450], [-0.13329982, -1.451984e+00, -1.02249882, -1.567847e+00, -1.49940589, -1.781022e+00, -1.27972730, -4.3121653, -2.67948840, -2.30545248, -2.95382964, -2.60659429, -3.147344e+00, -2.60913233, -2.673216e+00, -2.70395227, -2.64059797, -8.745954e-01, 0.88524607, -3.158829e+00, -1.532546e+00, 0.09266597, -2.914030e+00, -2.6250173, -1.342829e+00, -0.64662735, -0.43686544, -2.09865322, -1.519102101, -2.646319e+00, -1.70747529, 0.89707281, 0.3066956, 3.08995611, -1.19368680], [1.52092905, 3.259918e+00, 2.40838600, 2.871969e+00, 3.09341297, 3.933910e+00, 3.73683573, 5.7564079, 4.35764767, 3.31813996, 4.18205352, 3.10672016, 3.218608e+00, 2.67898919, 2.357314e+00, -0.70056511, -1.68801679, -1.602781e+00, -0.34567583, -2.044594e+00, -1.755141e+00, -0.45440822, -1.538904e+00, -2.5939321, -2.747498e+00, -1.28080182, -0.99409892, -2.84057656, -1.305285838, -9.766209e-01, -0.40284505, -0.27756038, -0.5397107, 4.82378296, 1.24205726], [0.12555626, -5.164036e-01, 0.04631478, -5.777127e-01, -0.22542671, 2.967644e-01, -0.61182539, -0.8243859, -0.06184360, 0.70893457, 0.43232784, 0.15735211, 6.040690e-01, 0.77280898, 7.694384e-01, -0.47463830, -1.03782668, -1.368550e+00, -1.21145518, -1.557196e+00, -2.303430e+00, -1.82390441, -2.169142e+00, -2.4186646, -1.367343e+00, -0.94630230, -0.93509247, -1.53650962, -1.321637726, -3.670951e+00, -4.37924159, -0.45592875, -3.0147021, 0.85525286, 0.58210920], [-0.55294211, 7.259003e-01, -0.13405784, 1.170870e+00, 0.67648687, 7.423729e-01, 0.03089698, 2.1762848, 1.80909252, 1.22782014, 1.48640345, 0.93741620, 9.455015e-01, 0.83294946, 1.167819e+00, -0.34111742, 0.29967272, 6.137995e-02, -1.17558891, 3.534104e-01, 6.210646e-01, -0.58457012, -4.794652e-01, -0.9427772, -1.751084e+00, -1.03318760, -1.32951928, -2.00889268, -1.899263799, -1.009080e+00, -2.77215776, -0.23279707, 0.1536449, 1.80205160, 1.72308629], [-0.84292428, -7.240828e-01, -0.18783875, -2.276676e-01, -0.17319786, -3.188255e-01, -3.19629287, -1.3641001, -0.62180837, -0.41375638, -1.34329317, -1.01205814, -7.984127e-01, -0.62797278, -6.486301e-01, -0.11435523, 0.03625112, -2.078555e+00, -1.65170346, -1.883270e+00, -1.656176e+00, -3.66675034, -3.099800e+00, -2.6033118, -1.004849e+00, -0.55472947, -0.69898102, -2.73888007, -1.580480802, -4.894187e+00, -6.31684492, -3.02072733, -1.6513180, -1.72628994, 1.64966498], [0.58700891, 2.533591e+00, 1.78137004, 2.183785e+00, 2.50339367, 2.351354e+00, 0.69156754, 2.4872038, 1.51129592, 1.83545066, 2.64303869, 1.91865134, 1.576801e+00, 0.75216425, 5.087367e-02, -0.18824949, 1.21772474, 2.707736e-01, -1.90104702, 1.688371e+00, 1.813622e+00, -0.06301625, 1.736327e+00, 1.8251318, 1.531628e+00, 0.56639938, 0.73485081, 1.69305992, 0.329180660, -1.099868e+00, -2.64154447, -2.15795069, -0.6603238, -0.45553474, -0.91044727], [-0.83415793, -9.237381e-01, -0.13605307, -6.640327e-01, -0.69872888, -1.053862e+00, -2.57543265, -2.2838630, -0.86367214, -0.42553165, -0.41312104, -0.41829424, -2.947966e-01, 0.61267035, 3.054356e-01, 0.30492975, -0.88056265, -2.053943e+00, -1.88146693, -1.818735e+00, -1.742755e+00, -1.07010395, -2.092101e+00, -2.2934475, -9.921462e-01, -0.65940619, -1.29734698, -2.14460743, -0.149219082, -1.123322e+00, -0.85028388, -1.09243236, -1.7484155, 1.07965678, -1.41680460], [-1.09559400, 8.752225e-01, 0.11894841, 1.412295e+00, 0.35075438, 1.177684e+00, 0.22637718, 1.4511574, 0.64680082, 1.02591542, 1.93749832, 1.52391763, 1.727282e+00, 2.24265094, 2.505160e+00, 2.25250414, 0.91597471, 1.836988e-01, -0.87855461, 2.178514e+00, 1.143963e+00, -0.21672121, 1.370155e+00, 0.6991980, 9.343378e-01, 0.33245579, 0.01881070, 1.36815233, -0.218940400, 9.519239e-02, -0.91836698, -2.25471571, 0.8385579, -0.51322330, -1.57342169], [-0.02387740, 1.928508e+00, 0.99791004, 2.009739e+00, 1.81165891, 2.394173e+00, 1.78346542, 2.2227813, 2.03253527, 1.61895789, 3.51168616, 3.13739560, 2.845314e+00, 3.71095248, 3.776803e+00, 1.39810535, -1.57526756, -3.222592e+00, -2.16501910, -2.499120e+00, -2.771815e+00, -3.00282112, -2.332177e+00, -2.3011830, -1.768804e+00, -0.72479856, -0.28197745, -1.58254826, -0.546327301, -1.085810e+00, -2.00566426, -2.90734205, 0.6635186, -3.25554509, -0.49570402], [0.70193942, 8.983500e-01, 0.46959549, 8.356255e-01, 1.43694426, 1.164194e+00, 2.69286894, 0.2766771, 1.08325737, 0.63212413, 1.07172161, 1.12083776, 1.142423e+00, 0.98642962, 8.381407e-01, 2.14839871, 2.40860798, 1.596700e+00, 2.00761769, 1.029942e+00, 5.332955e-01, 1.00251691, 1.477372e+00, 0.8825888, 7.543783e-01, -0.71170156, -0.66228059, 0.72120461, -0.112047972, 8.918786e-01, 2.81122334, 1.18774046, 1.6183223, 1.43545417, 1.96891353], [0.39181669, 1.288237e+00, 1.60737757, 7.814422e-01, 1.88927026, 1.701027e+00, 1.06322454, 2.1590953, 1.95923291, 1.52144924, 2.96889237, 2.84039247, 2.529072e+00, 1.72091607, 1.980772e+00, -0.26682328, -2.36439358, -3.115120e+00, -1.44706064, -3.195354e+00, -3.193999e+00, -4.53016456, -1.851243e+00, -2.2578876, -1.250965e+00, -1.00037953, -1.02811886, -1.91047284, -0.791022341, -1.868363e+00, -0.79503202, -3.12065068, 1.0982350, -0.98791805, 1.17235759], [-0.84975042, -6.042669e-01, -0.69995578, -3.855678e-01, -0.81858779, -4.477763e-01, -0.48064829, 1.0503627, -0.34075923, 0.05409725, -0.70536980, 0.15810693, 7.651033e-01, 0.53022488, 4.582444e-01, 2.25153660, 1.85012782, 4.967006e-01, 2.25063341, 6.230297e-01, 5.676067e-01, 0.50763531, 8.492886e-01, 0.4962994, -1.358876e+00, -0.44359800, -0.17973976, -0.38368966, 0.129729312, 2.040848e+00, 3.53169871, 0.72533970, 1.0386347, 0.49064948, 0.02608175], [0.92537534, 7.075020e-01, 0.82971380, 1.044658e+00, 0.46269672, 1.620570e+00, -0.93178459, 0.5179339, 0.88022346, 0.99439406, 1.47013324, 1.47939859, 1.497188e+00, 0.92313668, 4.794219e-01, -0.38780418, 0.19988400, -1.184432e+00, -1.56908773, -4.425361e-01, -1.032698e+00, -1.26721281, -2.000995e+00, -2.6358795, -2.502450e+00, -1.26815114, -0.77843387, -3.36357365, -1.536487004, -1.919820e+00, 0.64204764, 0.35792749, -1.4945154, 1.43738486, -0.58339537], [1.20178509, -2.000682e-01, 0.01693073, 2.133457e-01, 0.30763788, -2.667839e-01, 1.08970769, 0.2702089, -1.63401658, -1.05500883, -1.42481123, -1.28505382, -9.258686e-01, -1.41616250, -1.843747e+00, 0.11481250, 0.93181784, 5.366704e-01, -0.89659028, 2.318438e+00, 1.872510e+00, 1.74334003, 2.854597e+00, 3.3555994, 2.925989e-02, -0.48783305, -0.47083650, 0.74844394, 0.559798914, 4.525265e+00, 4.58477169, 1.99706784, 1.5080084, 0.06314047, -0.59944915], [2.07722881, 5.341312e-01, 0.77947626, 6.037828e-01, 1.17211573, 5.383573e-01, 0.77166599, 0.3726998, 0.25550811, 0.59648554, 0.38012092, 0.07006915, 5.868517e-03, -0.74238151, -1.497909e+00, 0.47577400, 1.06051627, 1.617059e+00, 1.80032305, 7.479881e-01, 2.043964e+00, 2.52557356, 1.219913e+00, 0.4803534, 4.667791e-01, 0.38887412, 0.38644969, 0.70774447, -0.336216608, 1.632456e+00, 3.00018553, 3.45481265, 0.7790756, 4.13703668, 0.06337106], [-2.24989837, -4.302763e-01, -1.74929544, -3.740111e-01, -1.07219551, -1.335091e-01, -3.16035682, -1.6740220, -1.90681805, -0.82402832, 0.16596253, -0.05064610, 9.294415e-02, 0.48398348, 6.499076e-01, 0.47855573, 0.35938927, 2.321464e+00, 2.41447364, 1.441026e+00, 2.963557e+00, 2.82913177, 3.384105e+00, 3.4473668, -4.024473e-01, -0.17129249, -0.29503759, 1.54836250, 1.513930909, 6.481393e+00, 4.51432690, 4.07080734, 0.8138094, 1.81949946, 0.57143108], [-1.01656994, -8.890316e-01, -1.29461899, -7.901383e-01, -0.68447103, -1.201129e+00, 0.28967262, -1.1334414, -1.77287724, -1.21672304, -1.69278076, -1.21148979, -5.146720e-01, -0.64248992, -4.680204e-01, 0.90215798, 1.42263597, 2.830218e+00, 1.05815930, 1.898014e+00, 3.858844e+00, 4.42466365, 2.854507e+00, 2.4693304, -2.348306e-02, -0.25772640, -0.37533300, 0.18576537, -0.361076485, 3.383409e+00, 3.70668446, 4.64448898, 0.2705007, 6.36882615, 0.10410477], [-0.50992353, -1.184197e-01, -0.12051278, 2.810264e-01, -0.11147047, 3.340698e-01, 0.03633611, 0.4288639, 0.58526527, 0.50172923, 0.90255473, 0.81175872, 4.213462e-01, 0.56000628, 2.846546e-01, -0.22039297, 0.48549177, 3.008412e-01, 0.16184718, 9.609462e-01, 1.354041e+00, 2.34607497, 2.872148e+00, 4.4758467, 1.733022e+00, 0.19684940, 0.18258232, 3.00324295, 0.889483650, 5.485918e+00, 3.83386430, 3.46360979, -1.4687842, 2.54672368, -0.27029831], [0.45902810, 1.699793e-01, 0.21554644, -5.523539e-01, 0.57907943, 3.932309e-01, 1.06041236, 0.6304128, 1.47611716, 0.54732013, 0.70397469, 0.91704818, 1.414214e+00, 0.11566881, 2.830642e-01, 1.81901051, 1.94932693, 2.850322e+00, 0.94791735, 2.498273e+00, 3.156392e+00, 6.11465651, 2.362363e+00, 2.9962383, 9.802733e-01, 0.57738645, 0.65135804, 1.07888362, 0.240927614, 2.919394e+00, 2.38432923, 3.48394353, 0.1052820, 4.75600853, 0.71530482], [-0.24349431, -8.439431e-01, -0.66341302, -4.697805e-01, -0.71829961, -2.732005e-01, -0.84448579, -0.8273185, -0.23995555, -0.11808013, -0.08633229, -0.39362060, -3.178583e-01, 0.17521182, -1.559364e-01, -0.38649251, -0.32610195, 9.177964e-01, 0.63200688, -2.276129e-01, 3.370388e-01, 3.90440681, 6.545717e-01, 1.4367193, -9.454337e-03, -0.29152578, -0.22592465, 1.39639653, 0.849624428, 2.994090e+00, 1.29402269, 2.44582665, -1.0828134, -0.94532233, 0.40325778], [-1.39223110, -1.622055e+00, -1.20778530, -1.069178e+00, -1.43637684, -1.159123e+00, -1.22136458, -1.6760825, -0.11519447, 0.25278374, -0.27100938, -0.23787892, 2.735731e-01, -0.17959874, 2.264140e-01, 0.19796455, 1.21407987, 1.426652e+00, 0.11194166, 8.415828e-01, 1.649631e+00, 3.54137935, 1.501209e+00, 0.3463514, -8.164126e-01, -0.88062879, -0.72262526, -0.01791845, 0.235655888, 2.037726e+00, 2.34970417, 1.09734909, 0.0682573, 0.60407452, 0.90443122], [-1.02392565, -5.673491e-01, -0.70964602, -3.687754e-01, -0.36096089, -8.638283e-01, -1.77941475, -2.7969361, -1.42330776, -1.55866903, -1.61706674, -1.73253802, -1.134115e+00, -0.04767659, -3.778682e-01, -0.20021839, 1.00107533, 1.643225e+00, -0.20567176, 1.323667e+00, 9.398355e-01, 0.43918670, 5.056253e-01, 0.7109244, 4.193428e-01, 0.06621289, -0.24312743, -0.07837749, -0.140794080, 2.557637e-01, -1.59921821, 0.21465080, -0.8936323, -3.11880272, -1.03891844], [-0.82870195, -2.099606e-01, -0.15920175, -3.192975e-01, -0.58927883, -9.958981e-01, -0.45918863, -2.1210116, -0.80747556, 0.17178359, -0.18338013, -0.35841963, 7.590088e-02, 0.31752054, 4.301735e-01, 1.37493985, 1.52285479, 2.249923e+00, 0.67516745, 1.533434e+00, 2.182756e+00, 0.76057515, 1.629477e+00, 1.3988561, 9.473159e-01, 0.31546383, 0.03214408, 0.94171111, 0.339876393, -2.163501e+00, -1.41146876, -0.71298005, -0.6075998, -2.80944526, 0.06488881], [1.28418890, 3.649906e-01, 0.59380554, 1.759908e-03, 0.89014875, 9.566813e-01, 0.03879258, -0.4865600, -0.46720751, 0.21530793, 1.34206318, 0.19911945, 1.026378e-02, -0.05133407, 3.608472e-01, 0.60363157, 0.03253768, 3.366076e-01, 0.68156764, -5.036516e-01, -5.293649e-02, 1.04943224, 3.554001e-01, -0.5084141, 2.388126e-01, 0.07516278, 0.15713984, -0.12204924, -0.349544186, -2.160509e-01, -2.09680497, 0.76599707, -0.2259136, 0.61532440, 0.16331847], [1.00794962, -3.810249e-01, -0.12973934, 2.508333e-01, -0.17568826, 8.686412e-02, 1.37622548, 0.8415755, 1.18632403, 0.56813310, 0.86185305, 0.28815620, -2.965147e-02, 0.72854260, 3.082082e-01, 0.50788173, -0.22606523, -4.097192e-01, -0.15607617, -1.394077e+00, -8.780649e-01, -2.35070263, -1.711104e+00, -1.6499690, -3.468064e-01, 0.33841614, 0.39654237, -1.05243700, -0.331145258, -1.292601e+00, -1.25903999, -1.08741339, 1.0970864, -1.42529199, -0.72820593], [-1.58154333, -1.390164e+00, -1.20625557, -1.409198e+00, -1.04509734, -1.179929e+00, 0.07190697, -1.6489419, -0.95285604, -1.53267498, -2.04393750, -1.44254455, -1.050924e+00, -0.27768119, -2.803571e-03, 0.88536754, 1.00612466, 6.708885e-01, -0.17207077, 3.065130e-01, 9.812993e-01, 1.59942069, -8.212277e-01, -0.5297174, -1.261708e-02, -0.05160913, -0.17776824, -1.94493722, -0.547986131, -7.006174e-01, -2.50788964, -0.52733872, 0.7161020, -1.67369274, 1.50037798], [-0.45628757, -1.512576e+00, -1.24477454, -1.315945e+00, -1.36949210, -1.196824e+00, -0.09191878, -1.4566100, -1.23237563, -1.32163296, -1.26507453, -0.77997970, -4.037119e-01, 0.13454366, -1.144565e-01, 1.05612140, 0.10194231, 2.284894e-01, 0.58973367, 3.054403e-01, 5.821388e-01, 0.54479869, -7.658625e-01, -2.1371981, -7.184237e-01, -0.05619105, -0.23008535, -1.91233567, -1.059662431, -5.892829e-01, -0.07389768, -0.87797601, -1.1497557, -3.22940075, -0.51134054], [2.24355893, 2.987791e-01, 1.57003140, -6.577640e-01, 0.95599659, -3.234701e-01, 1.03488812, -1.6822629, -0.49675688, -1.40446335, -1.68761302, -1.80113977, -1.910319e+00, -1.31372456, -1.796134e+00, -0.78463456, 0.13496712, 3.548790e-01, -0.15189028, 3.527213e-01, 3.898108e-01, 1.61126487, -9.367634e-01, -0.1448268, 5.824714e-01, 0.86455257, 1.03595041, -0.73132245, -0.581587321, 4.870423e-01, 0.69273813, 0.40620599, 0.4264222, 2.22542172, -0.64908154], [0.03151138, -1.429253e+00, -0.33020856, -8.769927e-01, -1.05542294, -1.479335e+00, 0.28840750, -1.8588508, -1.91150763, -1.58731427, -2.45159863, -2.14016373, -1.856729e+00, -1.45426533, -1.499989e+00, -0.14273784, 0.65881620, -4.381416e-01, -2.25086798, 6.856435e-01, 1.284126e-01, 0.16678078, -7.691342e-01, -1.6276582, 3.319708e-01, -0.06524522, -0.13800628, -1.80628763, -0.626905087, 1.746483e-01, 2.40221924, -0.43184965, 1.4377209, -1.81368469, -0.63079462], [-0.19420235, 1.017261e+00, 0.44046808, 2.235912e-01, 0.82711704, 1.488388e-01, 1.11226175, -0.6765021, -0.50506171, -0.57656726, -0.11680901, -0.76164050, -1.120442e+00, -1.41198785, -1.707052e+00, 0.03169615, 0.42995819, -6.548027e-01, -0.92319645, 9.372992e-01, 4.472379e-01, -0.64736446, 2.350966e-03, 0.8167789, 1.532516e-01, 0.26300417, 0.27715292, -0.22968922, -0.318246824, 7.685206e-01, 1.26979359, -0.60094669, 1.6978479, 2.50160157, -1.09154674], [0.40872749, 5.316905e-01, 0.07574449, 3.738896e-01, 0.49030229, 2.154546e-01, 1.20505168, -0.3998987, 0.45921862, 0.12764587, 0.24036029, 0.04300324, 2.611705e-02, -0.38701871, -7.228944e-01, -0.06229737, 0.02990214, -1.022368e+00, -1.27149324, 1.078780e+00, 4.584915e-01, -2.08859968, 6.685534e-01, 0.1185499, -6.889925e-01, -0.50159233, -0.62806797, -0.40109349, 0.478865976, 1.012569e+00, 1.74002151, -2.58437083, 0.2119228, -1.26496072, -0.83611301], [-1.20693909, -8.648244e-02, -0.68445745, -4.231141e-02, 0.07030813, 2.977115e-02, 1.61514664, 0.3613738, 0.98519906, 0.56038201, 0.68799786, 0.25726847, 2.943262e-01, 0.03265916, 4.871384e-01, 1.08699337, -0.14340130, 1.158565e+00, 2.67213822, -1.448469e-01, -3.759568e-01, 1.47032173, 9.272117e-01, 0.6709135, 1.699794e-01, 0.30539670, 0.64835640, 0.01487555, -0.728060109, -1.132007e+00, -0.59876173, -0.01768361, 1.2546856, 0.47877009, -0.46534162], [0.74070647, 1.881216e-01, 0.10590741, 6.856033e-01, -0.01494294, 4.620404e-01, -0.37088003, -0.3991986, 0.63966992, 0.62867809, 1.13309925, 1.03074702, 1.180520e+00, 0.94804892, 3.586752e-01, -0.48021134, -1.97926806, -3.987384e-03, 0.15562854, -3.272787e-02, 9.576702e-01, 0.42574563, 2.626444e+00, 2.4926891, 1.194390e+00, 0.21078992, 0.58478490, 2.17276930, 1.311293068, 9.013753e-01, -0.58093539, 0.25607094, 1.0480987, -0.19546428, -1.78147390], [0.58252591, 4.277163e-01, 0.90430340, 1.034826e-01, 0.58591696, 5.142170e-01, 0.95038449, -0.3056090, 0.30011349, 0.97574674, 0.44413519, 0.40519577, 6.835409e-01, 2.13472092, 2.159293e+00, 1.55883723, 0.17847583, -1.351055e-01, 1.94473047, -4.080991e-01, -9.536895e-01, 2.11378246, 9.719330e-03, -0.1195651, -6.975778e-01, -0.94429705, -0.85992101, -0.02517769, 0.007567667, -1.473490e+00, -2.56068088, 0.23898731, 2.6713763, -1.15294033, 1.89343762], [0.51086899, 1.945461e-01, 0.35563999, 1.376437e-01, 0.41130673, -1.761141e-01, 0.70332114, -1.5772770, -0.40116904, -0.30775824, -0.18106109, -0.35859266, 4.523594e-02, 0.08296053, -2.474059e-01, 0.99918091, 0.16696234, -2.655998e-01, 0.11855061, 1.604159e+00, 1.353651e+00, 0.76703312, 1.713040e+00, 2.2453633, 1.112115e+00, 0.58666241, 0.77868287, 1.85247340, 1.005655963, 2.964966e-01, -0.75506257, -0.46511248, 2.5370339, 0.12240512, -0.76445357], [1.14540932, 4.230023e-01, 0.82329579, 2.522589e-01, 0.40010288, -1.159966e-01, -0.58847402, -1.4912045, -0.91540235, -0.70744602, -1.63973010, -1.16779949, -6.924016e-01, -0.12211442, 2.142196e-01, -0.95961729, -0.03517539, 6.954538e-01, -0.07720068, -7.311228e-01, -2.358224e-01, 0.61405116, -1.503198e-01, -0.9694861, -1.794021e+00, -0.68244899, -0.67482556, -1.16556735, -0.013233124, -1.698246e+00, -1.36983520, 0.31130760, 0.7389527, -0.84510408, 1.18858326], [1.74285071, 2.506958e+00, 2.76422771, 1.654996e+00, 2.28409145, 2.352266e+00, 1.72266916, 0.9046326, 2.32138310, 2.34904150, 2.85547750, 2.73975738, 2.621758e+00, 2.49867607, 2.462475e+00, 2.05542418, 0.62659544, 1.181264e+00, 0.44256888, 1.147806e-01, 1.122830e+00, 0.21694589, 7.742090e-01, 0.9181116, -1.400702e-01, -0.13253731, -0.61253172, 0.69978709, -0.192494238, -3.563360e-01, -1.27044350, -0.19247570, 0.8062723, -3.03513839, -0.75634886], [-1.85078404, -7.183344e-01, -0.38240584, -9.209318e-01, -0.55601263, -1.572229e-01, -0.30486141, -0.5511934, 0.44767040, -0.17350576, -0.27735373, 0.08864750, -9.293620e-02, 1.13317491, 7.132884e-01, 1.04196753, 2.27408855, 1.160518e+00, 1.79245281, 6.472166e-01, 7.166789e-01, 1.51546460, 1.067069e-01, 0.1304825, 5.333138e-01, 0.32225323, 0.11127284, 0.21314949, 0.462165374, 4.007278e-03, -0.03874602, 0.92968477, -2.1448894, 0.55525031, -0.53638872], [-0.24538532, 1.038213e+00, 0.22348443, 1.524884e+00, 1.02875904, 1.374557e+00, 0.95412042, 0.8511914, 1.30296742, 0.92884887, 1.71803275, 1.22633650, 1.339939e+00, 0.42608840, -1.901805e-01, -0.20046471, -0.98173732, -8.768400e-01, -1.65674072, -1.939138e-01, -4.038453e-01, -0.69586081, -7.000077e-01, -0.7295975, -2.086565e-01, 0.17521970, 0.05716848, 1.18548477, 0.272045330, -3.792776e-01, -0.73572734, -1.67429640, -1.2667567, 0.43780133, -0.54679839], [-0.20314284, -4.928191e-02, -0.47170388, -3.994800e-01, -0.01959643, 7.333726e-02, -0.04472905, 2.4390476, 1.39536759, 0.19688113, 0.13007568, 0.34144884, 3.527637e-01, 1.15212885, 7.171617e-01, 0.68313280, 0.75987149, -2.710371e-01, 0.14343316, 9.875637e-01, 3.633765e-01, -1.24790369, 5.623962e-01, 0.4395609, 9.299851e-01, 0.28522147, 0.46285969, 0.72755880, 0.186921131, -7.914515e-01, 0.01194463, 0.70348229, 0.3314508, 0.56448351, -2.60371925]])
        x1 = FDataBasis(x1basis, np.transpose(x1coefficients))

        x1.plot()

        beta0 = Constant(domain_range=(0, 365))
        beta1 = Fourier(domain_range=(0, 365), nbasis=5)

        functional = ScalarRegression([beta0, beta1])

        functional.fit(y, [x0, x1])

        testing.assert_allclose(functional.beta[1].coefficients.round(3),
                                   np.array([[0.0006011817, -0.0014284904, 0.0041845742, -0.0160814209, 0.0028040342]]).round(3))


if __name__ == '__main__':
    print()
    unittest.main()
